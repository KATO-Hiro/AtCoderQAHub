.main
  .problems-wrapper
    .container
      .heading
        .problems
          - atcoder = "https://atcoder.jp/contests/"
          - url = atcoder + @problem.contest_id + "/tasks/" + @problem.task_id

          h2
            = link_to("#{@problem.contest_id.upcase + ": " + @problem.title}", url, target: "_blank")

          / ログイン状態のときだけ質問の投稿を許可する
          - if @current_user
            = link_to("New Question", "/problems/#{@problem.task_id}/questions/new}", class: "btn")

          / FIXME: CSSで配置を調整する
          br
          br

          - # DBから該当する問題の質問のみ抽出
          - @questions = Question.where(task_id: @problem.task_id)

          table[border="1" width="100%"]
            col[style="width:90%"]
            col[style="width:10%"]
            thead
              tr
                th
                  = @questions.count
                  |  Questions
                th
                  | Answers
            thead

            tbody
              - @questions.each do |question|
                tr
                  / TODO: 質問にリンクを貼る
                  / TODO: 質問を左寄せする
                  td
                    / FIXME: idが全体としての通し番号になっているため，問題ごとに集計する
                    - url = "/problems/#{@problem.task_id}/questions/#{question.id}"
                    = link_to("#{question.title}", "#{url}")

                  td
                    - answers = Answer.where(question_id: question.id)
                    = answers.count
          br

          / TODO: 入力フォームを用意

          = link_to("◀ Return to list", "/problems/", class: "btn")
